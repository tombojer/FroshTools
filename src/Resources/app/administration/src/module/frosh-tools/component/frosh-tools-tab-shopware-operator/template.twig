<div class="frosh-tools-tab-shopware-operator">
    <sw-card
        deprecated
        :title="$t('frosh-tools.tabs.shopwareOperator.title')"
        :large="true"
        positionIdentifier="frosh-tools-shopware-operator"
    >
        <sw-card-section>
            <sw-loader v-if="isLoading"></sw-loader>
            <sw-container v-else-if="error" columns="1fr" justify="center">
                <sw-alert variant="error">{{ error }}</sw-alert>
            </sw-container>
            <div v-else>
                <!-- Pod Status -->
                <sw-card-section divider="bottom">
                    <h3>{{ $t('frosh-tools.tabs.shopwareOperator.pods.title') }}</h3>
                    <div class="metric-grid">
                        <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.pods.running') }}</div>
                            <div class="metric-card__value" style="color: #2c662d;">{{ data.pods.running }}</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.pods.pending') }}</div>
                            <div class="metric-card__value" style="color: #665d28;">{{ data.pods.pending }}</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.pods.failed') }}</div>
                            <div class="metric-card__value" style="color: #a30000;">{{ data.pods.failed }}</div>
                        </div>
                    </div>
                </sw-card-section>

                <!-- Resources -->
                <sw-card-section divider="bottom">
                    <h3>{{ $t('frosh-tools.tabs.shopwareOperator.resources.title') }}</h3>
                    <div class="metric-grid">
                        <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.resources.cpu') }}</div>
                            <div class="metric-card__value">{{ data.resources.cpuUsage }}</div>
                            <div class="metric-card__subtext">{{ $t('frosh-tools.tabs.shopwareOperator.resources.limit', { limit: data.resources.cpuLimit }) }}</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.resources.memory') }}</div>
                            <div class="metric-card__value">{{ data.resources.memoryUsage }}</div>
                            <div class="metric-card__subtext">{{ $t('frosh-tools.tabs.shopwareOperator.resources.limit', { limit: data.resources.memoryLimit }) }}</div>
                        </div>
                    </div>
                </sw-card-section>

                <!-- Status Overview (Cache, DB, S3) -->
                <sw-card-section divider="bottom">
                    <h3>{{ $t('frosh-tools.tabs.shopwareOperator.systemStatus') }}</h3>
                    <div class="metric-grid">
                         <!-- Cache -->
                        <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.cache.app') }}</div>
                            <span :class="getStatusClass(data.cache.appCache)">{{ data.cache.appCache }}</span>
                        </div>
                         <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.cache.session') }}</div>
                            <span :class="getStatusClass(data.cache.sessionCache)">{{ data.cache.sessionCache }}</span>
                        </div>
                        <!-- Database -->
                         <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.database.title') }}</div>
                            <span :class="getStatusClass(data.database.status)">{{ data.database.status }}</span>
                             <div class="metric-card__subtext">{{ data.database.latency }} | {{ data.database.openConnections }} conns</div>
                        </div>
                         <!-- S3 -->
                         <div class="metric-card">
                            <div class="metric-card__label">{{ $t('frosh-tools.tabs.shopwareOperator.s3.title') }}</div>
                             <span :class="getStatusClass(data.s3.status)">{{ data.s3.status }}</span>
                        </div>
                    </div>
                </sw-card-section>

                 <!-- Scaling -->
                <sw-card-section divider="bottom">
                     <h3>{{ $t('frosh-tools.tabs.shopwareOperator.scaling.title') }}</h3>
                    <div class="metric-grid">
                        <div class="metric-card" v-for="(info, component) in data.scaling" :key="component">
                             <div class="metric-card__label">{{ component }}</div>
                             <div class="metric-card__value">{{ info.current }} / {{ info.desired }}</div>
                             <div class="metric-card__subtext">{{ $t('frosh-tools.tabs.shopwareOperator.scaling.replicas') }}</div>
                        </div>
                    </div>
                </sw-card-section>

                 <!-- Scheduled Tasks -->
                <sw-card-section>
                    <h3>{{ $t('frosh-tools.tabs.shopwareOperator.scheduledTasks.title') }}</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>{{ $t('frosh-tools.tabs.shopwareOperator.scheduledTasks.name') }}</th>
                                <th>{{ $t('frosh-tools.tabs.shopwareOperator.scheduledTasks.status') }}</th>
                                <th>{{ $t('frosh-tools.tabs.shopwareOperator.scheduledTasks.interval') }}</th>
                                <th>{{ $t('frosh-tools.tabs.shopwareOperator.scheduledTasks.lastRun') }}</th>
                                <th>{{ $t('frosh-tools.tabs.shopwareOperator.scheduledTasks.nextRun') }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="task in data.scheduledTasks" :key="task.name">
                                <td>{{ task.name }}</td>
                                <td><span :class="getStatusClass(task.status)">{{ task.status }}</span></td>
                                <td>{{ task.interval }}</td>
                                <td>{{ task.lastRun }}</td>
                                <td>{{ task.nextRun }}</td>
                            </tr>
                        </tbody>
                    </table>
                </sw-card-section>
            </div>
        </sw-card-section>
    </sw-card>
</div>
